
\section{Первичная и дуальная SDP задача}
Рассмотрим минимизацию линейной функции, зависящей от вектора $\bm{x} \in R^m$,
с дополнительным условием в виде матричного неравенства:

\begin{equation}\label{sdp-problem-def}
\begin{split}
    & \text{min }\bm{c}^T \bm{x}  \\
    & \text{s.t. } F(\bm{x} ) \geq 0,
\end{split}
\end{equation}

где $F(\bm{x}) = F_0 + \sum\limits_{i=1}^{m} x_i F_i$. Начальные данные в 
это задаче - вектор  $\bm{c} \in R^m$ и набор из $m+1$ матриц 
$F_0, F_1, ..., F_m \in R^{n \times n}$. Знак неравенства в условии 
$F(x) \geq 0$ означает, что матрица $F(x)$ положительно определенная, 
т.е. не имеет отрицательных собственных значений.
Также это условие эквивалентно следующему
$\forall \bm{x} \in R^m \hookrightarrow \bm{x}^TF(\bm{x})\bm{x} \geq 0$.
Такое неравенство еще называют \textbf{линейное матричное неравенство}.
Поставленная задача называется  \textbf{semidefinite program}
(далее сокращенно будем называть ее \textbf{SDP}).

Рассмотрим простой пример задачи $\bm{x}\in R^2$, $F(\bm{x})\in R^{7 \times 7}$.
Область $\bm{x}: F(\bm{x}) \geq 0$ на рис.(\ref{ris:sdp-example}) выделена черной линией.
Заметим, что данное множество всегда выпуклое.
Действительно, если $F(\bm{x}) \geq 0$ и $F(\bm{y}) \geq 0$,
тогда $\forall \lambda \in [0, 1]$:
\begin{equation}\label{sdp-convex}
F(\lambda \bm{x} + (1-\lambda) \bm{y})=
\lambda F(\bm{x}) + (1+\lambda) F(\bm{y}) \geq 0
\end{equation}

Коротко SDP задачу можно описать так: необходимо найти оптимальную точку, двигаясь как можно дальше в направлении, 
задающемся вектором $- \bm{c}$ и оставаясь при этом в допустимой области $\bm{x}: F(\bm{x}) \geq 0$.
В данном примере оптимальная точка обозначена как $\bm{x_{opt}}$.
\begin{figure}[h]
\center{
    \begin{overpic}[width=0.6\textwidth]{sdp-example.png}
        \put (60, 45) {$x_{opt}$}
        \put (80, 55) {$-c$}
        \put (30, 50) {$F(x) \geq 0$}
        \put (30, 20) {$F(x) \ngeq 0$}
    \end{overpic}
}
\caption{Приме SDP задачи в случае, когда $x\in R^2$, $F(x)\in R^{7 \times 7}$}
\label{ris:sdp-example}
\end{figure}

На первый взгляд может показаться, что постановка задачи SDP
(\ref{sdp-problem-def}) специфична и не имеет большого приложения
в реальных задачах физики. Но это далеко не так. Далее будет приведено несколько интересных примеров приложения SDP задач.

Самый простой пример SDP задачи - это минимизация максимального собственного значения и нормы матрицы.
Пусть у нас есть симметричная матрица 
$A(\bm{x}) = A_0 + A_1 x_1 + A_2 x_2 + ...$, где $\bm{x} \in R^k$ и $A_i = A_i^T \in R^{p \times p}$.
Задачу минимизации максимального собственного значения матрицы $A(\bm{x})$ можно представить как 
SDP задачу

\begin{equation}
    \begin{split}
        & \text{min }t \\
        & \text{s.t. } tI - A(\bm{x}) \geq 0,
    \end{split}
\end{equation}

с переменными $\bm{x}\in R^{k}$ и $t \in R$.
Задачи этого типа возникают в теории управления, 
структурной оптимизации, теории графов и комбинаторной оптимизации и других областях
\cite{overton}, \cite{brualdi}.

Рассмотрим другой пример SDP задачи, который использовался в данной работе. \textbf{Дуальная SDP задача}
\begin{equation}\label{dual-sdp-def}
    \begin{split}
        & \max(-\Tr(F_0 Z)) \\
        & \text{s.t. } \Tr(F_i Z) =  c_i, i = 1,...,m, \\
        & Z \geq 0,
    \end{split}
\end{equation}
где переменная $Z = Z^{T} \in R^{n \times n}$, которая подчиняется $m$ условиям и должна быть положительно определенной.

Дуальная SDP задача \ref{dual-sdp-def} сводится SDP задачей \ref{sdp-problem-def}.
Для простоты предположим, что матрицы $F_1, F_2, ..., F_m$ линейно независимы. Тогда множество
\begin{equation}
    \{ Z | Z = Z^T \in R^{n \times n}, \Tr(F_i Z) = c_i, i=1, ..., m \}
\end{equation}
можно будет представить в следующей форме
\begin{equation}
    \{ G(y) = G_0 + y_1 G_1 + ... + y_p G_p | \bm{y} \in R^p \},
\end{equation}
где $p = \frac{n(n+1)}{2} - m$ и $G_i$ соответствующие матрицы. Определим $\bm{d} \in R^p$ как $d_i = \Tr(F_0 G_i)$. В этом случае $\bm{d}^T \bm{y} = \Tr(F_0(G(\bm{y}) - G_0))$. Таким образом, получим

\begin{equation}
\begin{split}
    & \min d^T y \\
    & \text{s.t. } G(y) \geq 0.
\end{split}
\end{equation}
Если сравнить полученную задачу с SDP задачей \ref{sdp-problem-def}, то можно заметить, что задачи эквивалентны. В дальнейшем задачу \ref{sdp-problem-def} будем называть \textbf{первичной} SDP задачей по отношению к дуальной SDP задаче.

Ключевое свойство дуальной задачи состоит в том, что она определяет границы оптимального значения первичной SDP задачи и наоборот. Предположим, что $Z$ решение дуальной задачи, а $x$ решение первичной SDP задачи. Тогда
\begin{equation}
    \bm{c}^T \bm{x} + \Tr(ZF_0) = \sum\limits_{i=0}^{m} \Tr(ZF_i)x_i + \Tr(ZF_0) = \Tr(ZF(\bm{x})) \geq 0,
\end{equation}
где используется факт, что $\Tr(AB) \geq 0$ когда $A = A^T \geq 0$ и  $B = B^T \geq 0$. Таким образом получаем
\begin{equation}\label{dual-and-primal-inequality}
    -\Tr(F_0Z) \leq c^Tx
\end{equation}
т. е. значение любой дуальной допустимой точки $Z$ меньше или равно любой первичной допустимой точки $x$.
Разница называется разрывом дуальности.
\begin{equation}
    \eta = c^T \bm{x} + \Tr(F_0)Z = \Tr(F(\bm{x}))Z.
\end{equation}

Пусть $p^*$ оптимально решение SDP задачи \ref{sdp-problem-def}
\begin{equation}
    p^* = \inf \{\bm{c}^T\bm{x} | F(\bm{x}) \geq 0\}
\end{equation}
и пусть $Z$ принадлежит множеству допустимых матриц дуальной SDP задачи \ref{dual-sdp-def}.
В силу неравенства \ref{dual-and-primal-inequality}, можно утверждать, что
$-\Tr(Z F_0) \leq p^*$ или, другими словами, допустимые матрицы дуальной SDP задачи задают нижнюю границу
для оптимального решения первичной задачи.

Аналогично можно убедиться, что допустимые значения первичной задачи задают нижнюю границу для оптимального решения дуальной.
Пусть $d^*$ оптимальное решение 
\begin{equation}
    d^* = \sup \{ -\Tr(F_0 Z) | Z = Z^T \geq 0, \Tr(F_i Z) = c_i, i=1, ...,m \}.
\end{equation}
Тогда снова, в силу неравенства \ref{dual-and-primal-inequality}, получим, что $d^* \leq \bm{c}^T \bm{x}$.
Откуда следует, что $d^* \leq p^*$. То есть оптимальное решение дуальной задачи меньше или равно оптимального решения
первичной SDP задачи.

Интересен случай когда неравенство $d^* \leq p^*$ превращается в равенство. Это происходит, когда удовлетворяется одно из следующих условий(доказательство можно найти в статье \cite{Nesterov}):
\begin{enumerate}
\item  Первичная задача \ref{sdp-problem-def} \textbf{строго допустима}, т.е. существует $\bm{x}$, для которого $F(\bm{x}) > 0$.
\item  Дуальная задача \ref{dual-sdp-def} \textbf{строго допустима}, т.е. существует матрица $Z$, для которой справедливо
$Z = Z^T > 0$ и $\Tr(F_iZ) = c_i, i=1, ..., m$.
\end{enumerate}
Если выполняются оба условия, то решение обеих задач  \ref{dual-sdp-def} и \ref{sdp-problem-def} существует.